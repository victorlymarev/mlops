Я тут конечно наговнокодил, поэтому максимально честно (и неформально) опишу, что здесь происходит.

# Что где находится:

Папка app содержит все файлы связанные с самим приложением:

1. app.py - само приложение, в котором все написано. Я видел пункт о том, что лучше написать приложение в формате класса, но я посмотрел код других проектов, и почему-то все, что я видел на Fast API написано через отдельные функции. Поэтому решил оставить так. Хотя никаких проблем переписать нет. Это пара лишних строк кода. Внутренности всех функций этого файла работают через другие функции. Наверное, это не очень правильно, и в фастапи есть можно было реальзовать это красивее через dependencies, но я первый раз писал что-то подобное и в условиях поджимающего дедлайна не стал делать все хорошо, не дай бог что-то сломается.
2. app.py содержит 4 функции, внутри которых лежат другие импортируемые функции. Они содержаться в файлах train.py, predict.py и delete_model.py через них гиперпараметры добавляются в базу данных, а готовые модели сохраняются в папке models на сервере. Было бы хорошо разделить все эти файлы на модули, но когда я пытался это сделать у меня все ломалось.
3. Работа с базой данных осуществляется через 3 файла. В файле database.py осуществляется подключение к базе данных. В файле models.py находятся схемы таблиц базы данных. А через файл crud.py осуществяется взаимодействие с бд. То есть сначала в файле app.py мы вызываем какую-то функцию. Внутри нее вызывается другая функция (например из файла train.py). Внутри этого файла модель сохраняется и обращается к бд через функцию из crud.py.
4. В файле tests.py содержаться тесты к приложению. Они довольно слабые. Я просидел полдня, но так и не понял как писать тесты к загружаемым файлам. Сами тесты сделаны через стандартное API от fastapi для тестирование. Насколько я понял эта штука основана на pytest.
5. Dockerfile про него скажу ниже
6. Файлы от poetry

Остальные файлы:

data.csv это файл с данными

pg_data - папка с данными docker voluems

docker-compose - в нем лежат 3 образа. Из докерфайла, образ посгреса и образ приложения для взаимодействия с бд.

# Docker

Отдельно напишу о докере тк с ним не совсем все хорошо. 
1. Образ докерфайла не работает как я хотел бы. Он запускается, вроде даже ставит все библиотеки, но потом падает с exit code 2. Долго просидел с этим, но так и не понял в чем конкретно дело. Видимо, все это связано с poetry. Кажется, что если делать через реквайрементс и пип, то такой проблемы не было бы, но я хочу позже закончить этот проект нормально и поэтому оставил как есть. Если на лету найдешь в чем проблема, напиши в фидбеке пожалуйста.
2. Папка pg_data пустая. По идее туда должны копироваться данные, но они почему-то не копируются, при этом все данные куда-то сохраняюся и даже после удаления контейнеров все изменения сохраняются. Сранно. Но еще странне, что если делать эту папку скрытой (с точкой вначале), то все данные в нее копируются, но при этом ничего не работает. Буду благодарен за объяснение, если ты знаешь, почему так происходит.

Образ на докерхабе: https://hub.docker.com/repository/docker/victor197/app

# Как запустить

Для того, что бы запустить надо зайти в проект и в консоле вызвать docker-compose up. Запустятся все контейнеры, но контейнер с приложением через какое-то время упадет. Приложение можно запустить локально, зайдя в папку app, подключившись к среде поетри, и вызвав uvicorn app:app --reload (находясь в папке app)

По идее все должно заработать

И тесты лежат в файле tests.py

It ain't much but honest work

Позже хочу нормально освоить все это, но пока вот так. Спасибо за курс!
